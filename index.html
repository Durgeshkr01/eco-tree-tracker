<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="theme-color" content="#0a1628">
    <meta name="description" content="Calculate tree's carbon absorption, oxygen production & environmental impact">
    <title>EcoTree Tracker - Carbon & Oxygen Calculator</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800;900&display=swap" rel="stylesheet">
    <link rel="icon" type="image/svg+xml" href="favicon.svg">
    <link rel="manifest" href="manifest.json">
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- TensorFlow.js for ML-based measurements -->
    <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@4.11.0/dist/tf.min.js"></script>
    
    <!-- HTML2PDF Library -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    
    <!-- SheetJS for Excel Export -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    
    <!-- Login Check -->
    <script>
        // Check if user is logged in
        const studentSession = localStorage.getItem('studentSession');
        const adminSession = localStorage.getItem('adminSession');
        
        if (!studentSession && !adminSession) {
            // Not logged in - redirect to login page
            window.location.href = 'login.html';
        }
    </script>
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="container">
            <div class="header-content">
                <div class="header-text">
                    <h1><i class="fas fa-tree" style="margin-right: 8px;"></i>EcoTree Tracker</h1>
                    <p>Carbon absorption, oxygen production & environmental impact calculator</p>
                </div>
                <div style="display: flex; gap: 8px; flex-wrap: wrap; justify-content: center; margin-top: 10px;">
                    <button onclick="logout()" class="header-action-btn logout-btn-header">
                        <i class="fas fa-sign-out-alt"></i> Logout
                    </button>
                    <button id="installBtn" class="header-action-btn install-btn-header" style="display: none;">
                        <i class="fas fa-download"></i> Install
                    </button>
                </div>
            </div>
        </div>
    </header>

    <!-- Main Container -->
    <main class="container">
        <!-- Input Form Section -->
        <section class="card input-section">
            <h2><i class="fas fa-tree"></i> Tree Details</h2>
            <form id="treeForm">
                <!-- Tree Species -->
                <div class="form-group">
                    <label for="treeSpecies">
                        <i class="fas fa-leaf"></i> Tree Species
                    </label>
                    <input type="text" id="treeSearch" placeholder="Search tree species..." autocomplete="off">
                    <select id="treeSpecies" required size="5" style="display:none;">
                        <option value="">Select Tree Species</option>
                    </select>
                    <div id="treeDropdown" class="tree-dropdown"></div>
                </div>

                <!-- Circumference Input -->
                <div class="form-group">
                    <label for="circumference">
                        <i class="fas fa-circle-notch"></i> Tree Circumference (at Breast Height)
                    </label>
                    <div style="display: flex; gap: 10px; margin-bottom: 12px;">
                        <button type="button" id="openCameraBtn" class="btn-secondary" style="flex: 1; padding: 12px 14px; font-size: 0.9rem; background: linear-gradient(135deg, #27ae60, #2ecc71); border-radius: 12px; font-weight: 700; box-shadow: 0 3px 12px rgba(39,174,96,0.3);">
                            <i class="fas fa-camera"></i> AI Camera
                        </button>
                        <button type="button" id="manualInputBtn" class="btn-secondary" style="flex: 1; padding: 12px 14px; font-size: 0.9rem; background: linear-gradient(135deg, #636e72, #747d8c); border-radius: 12px; font-weight: 600;">
                            <i class="fas fa-keyboard"></i> Manual Entry
                        </button>
                    </div>
                    <div class="input-with-unit" id="manualInputContainer">
                        <input type="number" id="circumference" step="0.1" min="0.1" placeholder="Enter circumference in cm" required>
                        <span class="unit-label">cm</span>
                    </div>
                    <small style="color: rgba(255,255,255,.4); display: block; margin-top: 5px; font-size: 0.8rem;">
                        <i class="fas fa-info-circle"></i> Use camera for automatic measurement or enter manually
                    </small>
                </div>

                <!-- Camera Modal -->
                <div id="cameraModal" class="camera-modal" style="display: none;">
                    <div class="camera-modal-content">
                        <div class="camera-modal-header">
                            <h3><i class="fas fa-microscope"></i> AI Tree Analyzer</h3>
                            <span style="font-size: 0.75em; opacity: 0.9; font-weight: normal;">Powered by Computer Vision</span>
                            <button id="closeCameraBtn" class="close-btn">&times;</button>
                        </div>
                        
                        <div class="camera-instructions">
                            <p><strong><i class="fas fa-magic"></i> Smart Auto-Detection</strong></p>
                            <div class="instruction-steps">
                                <div class="instruction-step">
                                    <span class="step-num">1</span>
                                    <span>Select tree species above for best accuracy</span>
                                </div>
                                <div class="instruction-step">
                                    <span class="step-num">2</span>
                                    <span>Stand <strong>2-3 meters</strong> from the tree</span>
                                </div>
                                <div class="instruction-step">
                                    <span class="step-num">3</span>
                                    <span>Center the trunk in frame, hold camera at chest height</span>
                                </div>
                                <div class="instruction-step">
                                    <span class="step-num">4</span>
                                    <span>Tap <strong>Capture</strong> â€” circumference auto-fills!</span>
                                </div>
                            </div>
                            <p class="tech-badge">
                                <i class="fas fa-brain"></i> Edge Detection + HSV/LAB Analysis + Species Calibration + Camera Geometry
                            </p>
                        </div>

                        <div class="reference-selector">
                            <label><i class="fas fa-ruler"></i> Reference Object:</label>
                            <select id="referenceObject" class="reference-select">
                                <option value="credit-card">Credit Card (8.5 cm)</option>
                                <option value="a4-paper">A4 Paper (21 cm width)</option>
                                <option value="coin-10rs">10 Rs Coin (2.7 cm)</option>
                                <option value="hand">Hand Width (~9 cm)</option>
                                <option value="custom">Custom Size</option>
                            </select>
                        </div>

                        <div id="customSizeInput" style="display: none; margin: 10px 0;">
                            <label>Custom Width (cm):</label>
                            <input type="number" id="customWidth" step="0.1" min="0.1" placeholder="Enter width in cm">
                        </div>

                        <div class="camera-container">
                            <video id="cameraVideo" autoplay playsinline></video>
                            <canvas id="cameraCanvas" style="display: none;"></canvas>
                            <canvas id="resultCanvas"></canvas>
                        </div>

                        <div class="camera-controls">
                            <button id="captureBtn" class="btn-primary" style="background: linear-gradient(135deg, #27ae60, #2ecc71); min-width: 200px;">
                                <i class="fas fa-camera"></i> Capture & Analyze
                            </button>
                            <button id="retakeBtn" class="btn-secondary" style="display: none; background: rgba(245,158,11,0.15); color: #fbbf24; border-color: rgba(245,158,11,0.2);">
                                <i class="fas fa-redo"></i> Retake Photo
                            </button>
                        </div>

                        <div id="measurementStep" style="display: none;">
                            <p style="margin: 15px 0; color: #f87171; font-weight: bold;">
                                <i class="fas fa-hand-pointer" style="margin-right:4px;"></i> Click and drag to mark the reference object width
                            </p>
                            <div style="margin: 10px 0;">
                                <label>Reference Width (pixels): <span id="pixelWidth">0</span></label>
                            </div>
                            <button id="calculateMeasurementBtn" class="btn-primary" disabled>
                                <i class="fas fa-calculator"></i> Calculate Measurements
                            </button>
                        </div>

                        <div id="measurementResults" style="display: none;">
                            <div class="measurement-result-card">
                                <h4><i class="fas fa-chart-bar"></i> AI Detection Results</h4>
                                <div class="measurement-values">
                                    <p><strong><i class="fas fa-arrows-alt-v" style="color:#27ae60;"></i> Tree Height</strong> <span id="detectedHeight">-</span> cm</p>
                                    <p><strong><i class="fas fa-arrows-alt-h" style="color:#3498db;"></i> Trunk Diameter</strong> <span id="detectedWidth">-</span> cm</p>
                                    <p class="highlight-row"><strong><i class="fas fa-circle-notch" style="color:#e74c3c;"></i> Circumference (DBH)</strong> <span id="detectedCircumference" style="color: #e74c3c; font-size: 1.3em; font-weight: bold;">-</span> cm</p>
                                    <p><strong><i class="fas fa-bullseye" style="color:#f39c12;"></i> Confidence</strong> <span id="detectedConfidence">-</span>%</p>
                                </div>
                                <button id="useMeasurementBtn" class="btn-primary use-measurement-btn">
                                    <i class="fas fa-check-circle"></i> Use This Measurement & Calculate
                                </button>
                                <p style="text-align: center; margin-top: 8px; font-size: 12px; color: rgba(255,255,255,0.4);">
                                    Circumference will auto-fill and calculate environmental impact
                                </p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Age (Optional) -->
                <div class="form-group">
                    <label for="age">
                        <i class="fas fa-calendar-alt"></i> Tree Age (Optional)
                    </label>
                    <input type="number" id="age" min="1" placeholder="Enter age in years">
                </div>

                <!-- GPS Location -->
                <div class="form-group">
                    <label>
                        <i class="fas fa-map-marker-alt"></i> GPS Location
                    </label>
                    <div style="display: flex; gap: 8px; margin-bottom: 10px; flex-wrap: wrap;">
                        <button type="button" id="getLocationBtn" class="btn-secondary" style="flex: 1; padding: 10px 14px; font-size: 0.85rem; min-width: 140px;">
                            <i class="fas fa-crosshairs"></i> Get Location
                        </button>
                        <button type="button" id="lockLocationBtn" class="btn-secondary" style="flex: 1; padding: 10px 14px; font-size: 0.85rem; background: rgba(16,185,129,0.2); color: #34d399; border-color: rgba(16,185,129,0.3); display: none;">
                            <i class="fas fa-lock"></i> Lock Location
                        </button>
                        <button type="button" id="unlockLocationBtn" class="btn-secondary" style="padding: 10px 14px; font-size: 0.85rem; background: rgba(239,68,68,0.15); color: #fca5a5; border-color: rgba(239,68,68,0.2); display: none;">
                            <i class="fas fa-unlock"></i> Unlock
                        </button>
                    </div>
                    <div class="gps-fields">
                        <div style="display: flex; gap: 10px;">
                            <div style="flex: 1;">
                                <label for="latitude" style="font-size: 0.9em; color: rgba(255,255,255,0.5);">Latitude</label>
                                <input type="text" id="latitude" placeholder="Auto-filled" readonly style="background: rgba(255,255,255,0.06); color: rgba(255,255,255,0.9); border: 1px solid rgba(255,255,255,0.08);">
                            </div>
                            <div style="flex: 1;">
                                <label for="longitude" style="font-size: 0.9em; color: rgba(255,255,255,0.5);">Longitude</label>
                                <input type="text" id="longitude" placeholder="Auto-filled" readonly style="background: rgba(255,255,255,0.06); color: rgba(255,255,255,0.9); border: 1px solid rgba(255,255,255,0.08);">
                            </div>
                        </div>
                    </div>
                    <p style="font-size: 0.82em; color: rgba(255,255,255,.35); margin-top: 8px;">
                        <i class="fas fa-lightbulb" style="color: #fbbf24;"></i> Click "Get Location" then lock it to use same coordinates for multiple trees
                    </p>
                </div>

                <!-- Calculate Button -->
                <button type="submit" class="btn-primary">
                    <i class="fas fa-calculator"></i> Calculate
                </button>
            </form>
        </section>

        <!-- Results Section -->
        <section id="resultsSection" class="results-section" style="display: none;">
            <div class="results-header">
                <h2><i class="fas fa-chart-line"></i> Calculation Results</h2>
                <div class="action-buttons">
                    <button id="downloadPDF" class="btn-secondary">
                        <i class="fas fa-download"></i> Download PDF
                    </button>
                    <button id="shareBtn" class="btn-secondary">
                        <i class="fas fa-share-alt"></i> Share
                    </button>
                </div>
            </div>

            <!-- Tree Info Summary -->
            <div class="tree-summary card">
                <h3 id="treeName">Tree Information</h3>
                <div class="tree-details" id="treeDetails"></div>
            </div>

            <!-- Results Cards Grid -->
            <div class="results-grid">
                <!-- Biomass Card -->
                <div class="result-card card">
                    <div class="card-icon biomass-icon">
                        <i class="fas fa-weight"></i>
                    </div>
                    <h3>Total Biomass</h3>
                    <div class="result-value" id="biomassValue">0</div>
                    <div class="result-unit">kg</div>
                    <div class="result-breakdown">
                        <small>Above-ground: <span id="agbValue">0</span> kg</small>
                        <small>Below-ground: <span id="bgbValue">0</span> kg</small>
                    </div>
                </div>

                <!-- Carbon Stored Card -->
                <div class="result-card card">
                    <div class="card-icon carbon-icon">
                        <i class="fas fa-atom"></i>
                    </div>
                    <h3>Carbon Stored</h3>
                    <div class="result-value" id="carbonValue">0</div>
                    <div class="result-unit">kg C</div>
                    <div class="result-info">
                        <small>Locked in tree biomass</small>
                    </div>
                </div>

                <!-- CO2 Sequestration Card -->
                <div class="result-card card highlight">
                    <div class="card-icon co2-icon">
                        <i class="fas fa-cloud"></i>
                    </div>
                    <h3>COâ‚‚ Equivalent</h3>
                    <div class="result-value" id="co2Value">0</div>
                    <div class="result-unit">kg COâ‚‚</div>
                    <div class="result-breakdown">
                        <small><span id="co2Tonnes">0</span> tonnes COâ‚‚</small>
                    </div>
                </div>

                <!-- Oxygen Production Card -->
                <div class="result-card card highlight">
                    <div class="card-icon oxygen-icon">
                        <i class="fas fa-wind"></i>
                    </div>
                    <h3>Oxygen Produced</h3>
                    <div class="result-value" id="oxygenValue">0</div>
                    <div class="result-unit">kg Oâ‚‚/year</div>
                    <div class="result-info">
                        <small>Fresh air generated</small>
                    </div>
                </div>

                <!-- Air Pollution Card -->
                <div class="result-card card">
                    <div class="card-icon pollution-icon">
                        <i class="fas fa-smog"></i>
                    </div>
                    <h3>Pollution Absorbed</h3>
                    <div class="result-value" id="pollutionValue">0</div>
                    <div class="result-unit">kg/year</div>
                    <div class="result-info">
                        <small>PM2.5, NOâ‚‚, SOâ‚‚ removed</small>
                    </div>
                </div>

                <!-- Economic Value Card -->
                <div class="result-card card">
                    <div class="card-icon economic-icon">
                        <i class="fas fa-rupee-sign"></i>
                    </div>
                    <h3>Economic Value</h3>
                    <div class="result-value" id="economicValue">0</div>
                    <div class="result-unit">â‚¹/year</div>
                    <div class="result-info">
                        <small>Carbon credit value</small>
                    </div>
                </div>
            </div>

            <!-- Environmental Impact Summary -->
            <div class="card impact-summary">
                <h3><i class="fas fa-globe-americas"></i> Environmental Impact</h3>
                <div class="impact-grid">
                    <div class="impact-item">
                        <i class="fas fa-users"></i>
                        <div>
                            <strong id="peopleEquivalent">0</strong>
                            <small>People's oxygen supply (annual)</small>
                        </div>
                    </div>
                    <div class="impact-item">
                        <i class="fas fa-car"></i>
                        <div>
                            <strong id="carEquivalent">0</strong>
                            <small>km of car emissions offset</small>
                        </div>
                    </div>
                    <div class="impact-item">
                        <i class="fas fa-home"></i>
                        <div>
                            <strong id="homeEquivalent">0</strong>
                            <small>Days of home energy offset</small>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Know Your Tree - Agricultural Info Card -->
            <div class="tree-info-card" id="treeInfoCard" style="display: none;">
                <h3><i class="fas fa-book-open"></i> Know Your Tree - Agricultural Guide</h3>
                <div id="treeInfoContent">
                    <div class="info-item">
                        <span class="info-label"><i class="fas fa-leaf"></i> Uses:</span>
                        <span id="treeUses"></span>
                    </div>
                    <div class="info-item">
                        <span class="info-label"><i class="fas fa-seedling"></i> Benefits:</span>
                        <span id="treeBenefits"></span>
                    </div>
                    <div class="info-item fact-highlight">
                        <span class="info-label"><i class="fas fa-lightbulb"></i> Did You Know?</span>
                        <span id="treeFact"></span>
                    </div>
                </div>
            </div>
        </section>

        <!-- Calculation History Section -->
        <section class="card history-section">
            <div class="history-header">
                <h2><i class="fas fa-history"></i> Calculation History</h2>
                <div class="history-actions">
                    <button id="exportExcel" class="btn-export">
                        <i class="fas fa-file-excel"></i> Export to Excel
                    </button>
                    <button id="clearHistory" class="btn-clear">
                        <i class="fas fa-trash"></i> Clear All
                    </button>
                </div>
            </div>
            <div id="historyList" class="history-list">
                <p class="no-history">No calculations yet. Start by calculating a tree's impact!</p>
            </div>
        </section>

        <!-- Educational Content Section -->
        <section class="card educational-section">
            <h2><i class="fas fa-graduation-cap"></i> Understanding Carbon Sequestration</h2>
            
            <div class="education-grid">
                <div class="edu-card">
                    <div class="edu-icon"><i class="fas fa-tree" style="color: #34d399;"></i></div>
                    <h3>How Trees Absorb COâ‚‚</h3>
                    <p>Through photosynthesis, trees absorb carbon dioxide from the atmosphere and store carbon in their biomass (trunk, branches, leaves, and roots). The oxygen is released back into the air as a byproduct.</p>
                </div>
                
                <div class="edu-card">
                    <div class="edu-icon"><i class="fas fa-wind" style="color: #60a5fa;"></i></div>
                    <h3>Oxygen Production</h3>
                    <p>A mature tree produces approximately 260 pounds of oxygen per year. That's enough oxygen for two people annually! Trees are literally the lungs of our planet.</p>
                </div>
                
                <div class="edu-card">
                    <div class="edu-icon"><i class="fas fa-globe-americas" style="color: #a78bfa;"></i></div>
                    <h3>Climate Change Impact</h3>
                    <p>Trees are our best natural defense against climate change. They remove harmful COâ‚‚ from the atmosphere, reduce urban heat islands, and help regulate local and global temperatures.</p>
                </div>
                
                <div class="edu-card">
                    <div class="edu-icon"><i class="fas fa-industry" style="color: #f87171;"></i></div>
                    <h3>Air Pollution Removal</h3>
                    <p>Trees filter harmful pollutants like PM2.5, nitrogen dioxide, sulfur dioxide, and ozone from the air. Their leaves and bark act as natural air purifiers for our cities.</p>
                </div>
                
                <div class="edu-card">
                    <div class="edu-icon"><i class="fas fa-coins" style="color: #fbbf24;"></i></div>
                    <h3>Economic Value</h3>
                    <p>Beyond environmental benefits, trees provide economic value through carbon credits, increased property values, reduced energy costs, and improved public health.</p>
                </div>
                
                <div class="edu-card">
                    <div class="edu-icon"><i class="fas fa-chart-bar" style="color: #34d399;"></i></div>
                    <h3>Why Measure Trees?</h3>
                    <p>Measuring tree impact helps us understand their contribution to ecosystem services, plan urban forestry programs, and make data-driven decisions for environmental conservation.</p>
                </div>
            </div>
        </section>

        <!-- About the Science Section -->
        <section class="card science-section">
            <h2><i class="fas fa-flask"></i> About the Science</h2>
            
            <div class="science-content">
                <div class="methodology">
                    <h3>Our Methodology</h3>
                    <p>Our calculations are based on scientifically validated allometric equations specifically designed for Indian urban and dry tropical regions. The methodology follows IPCC guidelines and peer-reviewed research.</p>
                    
                    <div class="formula-box">
                        <h4>Key Formulas:</h4>
                        <ul>
                            <li><strong>DBH Calculation:</strong> DBH = Circumference Ã· 3.14</li>
                            <li><strong>Above-Ground Biomass:</strong> AGB = 34.4703 - 8.0671Ã—D + 0.6589Ã—DÂ²</li>
                            <li><strong>Below-Ground Biomass:</strong> BGB = 0.15 Ã— AGB</li>
                            <li><strong>Carbon Storage:</strong> Carbon = 0.5 Ã— Total Biomass</li>
                            <li><strong>COâ‚‚ Equivalent:</strong> COâ‚‚ = Carbon Ã— 3.67</li>
                            <li><strong>Oxygen Production:</strong> Oâ‚‚ = Carbon Ã— 2.67 (annual)</li>
                        </ul>
                    </div>
                </div>
                
                <div class="accuracy-note">
                    <h4><i class="fas fa-info-circle"></i> Accuracy Note</h4>
                    <p>These calculations provide estimates based on tree circumference at breast height (1.3m). Actual values may vary depending on tree species, age, health, environmental conditions, and local climate factors.</p>
                </div>
            </div>
        </section>

        <!-- FAQ Section -->
        <section class="card faq-section">
            <h2><i class="fas fa-question-circle"></i> Frequently Asked Questions</h2>
            
            <div class="faq-list">
                <div class="faq-item">
                    <button class="faq-question">
                        <span>How do I measure tree circumference accurately?</span>
                        <i class="fas fa-chevron-down"></i>
                    </button>
                    <div class="faq-answer">
                        <p>Use a measuring tape to measure around the tree trunk at breast height (approximately 1.3 meters or 4.5 feet from the ground). Ensure the tape is level and snug against the bark without compressing it. Record the measurement in centimeters.</p>
                    </div>
                </div>
                
                <div class="faq-item">
                    <button class="faq-question">
                        <span>How accurate are these calculations?</span>
                        <i class="fas fa-chevron-down"></i>
                    </button>
                    <div class="faq-answer">
                        <p>Our calculations use scientifically validated allometric equations with approximately 85-90% accuracy for most tree species. Results are estimates and may vary based on tree species, health, and environmental conditions.</p>
                    </div>
                </div>
                
                <div class="faq-item">
                    <button class="faq-question">
                        <span>Why do you need GPS location?</span>
                        <i class="fas fa-chevron-down"></i>
                    </button>
                    <div class="faq-answer">
                        <p>GPS location helps track trees geographically, create environmental impact maps, and analyze regional carbon sequestration patterns. It's optional but recommended for comprehensive tree tracking.</p>
                    </div>
                </div>
                
                <div class="faq-item">
                    <button class="faq-question">
                        <span>Can I use this for any tree species?</span>
                        <i class="fas fa-chevron-down"></i>
                    </button>
                    <div class="faq-answer">
                        <p>Yes! Our database includes common tree species found in India and tropical regions. The calculations use generalized equations that work well for most tree species, with species-specific adjustments where available.</p>
                    </div>
                </div>
                
                <div class="faq-item">
                    <button class="faq-question">
                        <span>What is the economic value calculation based on?</span>
                        <i class="fas fa-chevron-down"></i>
                    </button>
                    <div class="faq-answer">
                        <p>The economic value is calculated using a conservative carbon credit price of â‚¹1,500 per tonne of COâ‚‚. This represents the monetary value of the tree's carbon sequestration service in carbon markets.</p>
                    </div>
                </div>
                
                <div class="faq-item">
                    <button class="faq-question">
                        <span>How can I export my tree data?</span>
                        <i class="fas fa-chevron-down"></i>
                    </button>
                    <div class="faq-answer">
                        <p>Click the "Export to Excel" button in the Calculation History section. This will download a comprehensive Excel file with all your tree measurements, calculations, and GPS locations in an organized format.</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- Contact/Feedback Section -->
        <section class="card contact-section">
            <h2><i class="fas fa-envelope"></i> Contact & Feedback</h2>
            
            <div class="contact-grid">
                <div class="contact-info">
                    <h3>Get in Touch</h3>
                    <p>Have questions, suggestions, or want to collaborate? We'd love to hear from you!</p>
                    
                    <div class="contact-details">
                        <div class="contact-item">
                            <i class="fas fa-university"></i>
                            <div>
                                <strong>Institution</strong>
                                <p>Centurion University of Technology and Management<br>Paralakhemundi, Odisha</p>
                            </div>
                        </div>
                        
                        <div class="contact-item">
                            <i class="fas fa-envelope"></i>
                            <div>
                                <strong>Email</strong>
                                <p>durgeshraj0852@gmail.com</p>
                            </div>
                        </div>
                        
                        <div class="contact-item">
                            <i class="fas fa-globe"></i>
                            <div>
                                <strong>Project</strong>
                                <p>Carbon Sequestration Potential of Tree Species</p>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="feedback-form">
                    <h3>Send Feedback</h3>
                    <form id="feedbackForm">
                        <div class="form-group">
                            <input type="text" id="feedbackName" name="name" placeholder="Your Name" required>
                        </div>
                        <div class="form-group">
                            <input type="email" id="feedbackEmail" name="email" placeholder="Your Email" required>
                        </div>
                        <div class="form-group">
                            <textarea id="feedbackMessage" name="message" rows="4" placeholder="Your Message or Feedback" required></textarea>
                        </div>
                        <button type="submit" class="btn-primary">
                            <i class="fas fa-paper-plane"></i> Send Feedback
                        </button>
                    </form>
                </div>
            </div>
        </section>
    </main>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <p style="color: rgba(255,255,255,.4); font-size: 0.82rem;">Based on research: AGB = 34.4703 - 8.0671 x D + 0.6589 x D<sup>2</sup></p>
            <p style="color: rgba(255,255,255,.55); font-size: 0.88rem; margin-top: 6px;">Made with <span style="color: #10b981;">&#9829;</span> for a greener planet &mdash; <strong>EcoTree Tracker v3.0</strong></p>

            <!-- Project Guide Section -->
            <div class="guide-section">
                <h3><i class="fas fa-graduation-cap"></i> Project Guide</h3>
                <div class="guide-card">
                    <div class="guide-photo">
                        <img src="faculty/WhatsApp Image 2026-02-17 at 12.14.39 PM.jpeg" alt="Dr. Abha Manohar">
                    </div>
                    <div class="guide-info">
                        <h4>Dr. Abha Manohar</h4>
                        <p class="role">Project Guide & Mentor</p>
                        <p class="designation">Assistant Professor</p>
                        <p class="department">School of Agriculture, Centurion University</p>
                    </div>
                </div>
            </div>
            
            <div class="team-section">
                <h3><i class="fas fa-users"></i> Our Team</h3>
                <div class="team-grid">
                    <!-- Team Member 1: Durgesh Kumar -->
                    <div class="team-card">
                        <div class="team-photo">
                            <img src="team/durgesh.jpg" alt="Durgesh Kumar">
                        </div>
                        <h4>Durgesh Kumar</h4>
                        <p class="role">Lead Developer</p>
                        <div class="social-links">
                            <a href="https://www.instagram.com/dp.visualdiary?igsh=bHhwamptNHpqOW9i" target="_blank" class="social-icon instagram" title="Instagram">
                                <i class="fab fa-instagram"></i>
                            </a>
                            <a href="https://www.linkedin.com/in/durgesh-kumar-4709a12a5" target="_blank" class="social-icon linkedin" title="LinkedIn">
                                <i class="fab fa-linkedin"></i>
                            </a>
                            <a href="https://wa.me/919939128165" target="_blank" class="social-icon whatsapp" title="WhatsApp">
                                <i class="fab fa-whatsapp"></i>
                            </a>
                        </div>
                    </div>

                    <!-- Team Member 2: Yash Raj Anand -->
                    <div class="team-card">
                        <div class="team-photo">
                            <img src="team/yash.jpg" alt="Yash Raj Anand">
                        </div>
                        <h4>Yash Raj Anand</h4>
                        <p class="role">UI/UX Designer</p>
                        <div class="social-links">
                            <a href="https://www.instagram.com/rajput_____yash?utm_source=qr&igsh=MTg4bmJyNTdndHZ1NA==" target="_blank" class="social-icon instagram" title="Instagram">
                                <i class="fab fa-instagram"></i>
                            </a>
                            <a href="https://www.linkedin.com/in/yashrajanand" target="_blank" class="social-icon linkedin" title="LinkedIn">
                                <i class="fab fa-linkedin"></i>
                            </a>
                            <a href="https://wa.me/918340184545" target="_blank" class="social-icon whatsapp" title="WhatsApp">
                                <i class="fab fa-whatsapp"></i>
                            </a>
                        </div>
                    </div>

                    <!-- Team Member 3: Vikash Kumar -->
                    <div class="team-card">
                        <div class="team-photo">
                            <img src="team/vikash.jpeg" alt="Vikash Kumar">
                        </div>
                        <h4>Vikash Kumar</h4>
                        <p class="role">Backend Developer</p>
                        <div class="social-links">
                            <a href="https://www.instagram.com/vikash___kumar_00?utm_source=qr&igsh=eHM5bGRzd29sM3lx" target="_blank" class="social-icon instagram" title="Instagram">
                                <i class="fab fa-instagram"></i>
                            </a>
                            <a href="https://www.linkedin.com/in/vikash-kumar89" target="_blank" class="social-icon linkedin" title="LinkedIn">
                                <i class="fab fa-linkedin"></i>
                            </a>
                            <a href="https://wa.me/918789060869" target="_blank" class="social-icon whatsapp" title="WhatsApp">
                                <i class="fab fa-whatsapp"></i>
                            </a>
                        </div>
                    </div>
                </div>
                <p class="university-name">Centurion University of Technology and Management, Paralakhemundi</p>
            </div>
        </div>
    </footer>

    <!-- Scripts -->
    <script type="module" src="firebase-config.js?v=3"></script>
    <script src="tree-data.js"></script>
    <script src="calculator.js"></script>
    <script src="app.js?v=4"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    
    <!-- PWA Service Worker Registration -->
    <script>
        // Register Service Worker
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                const swPath = window.location.hostname === 'localhost' ? './service-worker.js' : '/eco-tree-tracker/service-worker.js';
                navigator.serviceWorker.register(swPath)
                    .then(reg => console.log('âœ… Service Worker registered!'))
                    .catch(err => console.log('âŒ Service Worker registration failed:', err));
            });
        }

        // PWA Install Button Logic
        let deferredPrompt;
        const installBtn = document.getElementById('installBtn');

        window.addEventListener('beforeinstallprompt', (e) => {
            e.preventDefault();
            deferredPrompt = e;
            installBtn.style.display = 'flex';
        });

        installBtn.addEventListener('click', async () => {
            if (!deferredPrompt) return;
            
            deferredPrompt.prompt();
            const { outcome } = await deferredPrompt.choiceResult;
            
            if (outcome === 'accepted') {
                console.log('ðŸŽ‰ App installed!');
            }
            
            deferredPrompt = null;
            installBtn.style.display = 'none';
        });

        window.addEventListener('appinstalled', () => {
            console.log('âœ… EcoTree Tracker installed successfully!');
            installBtn.style.display = 'none';
        });
        
        // Listen for service worker updates
        if ('serviceWorker' in navigator) {
            navigator.serviceWorker.addEventListener('message', event => {
                if (event.data && event.data.type === 'UPDATE_AVAILABLE') {
                    showUpdateNotification(event.data.version);
                }
            });
            
            // Check for updates on page load
            navigator.serviceWorker.ready.then(registration => {
                registration.update();
            });
        }
        
        // Show update notification
        function showUpdateNotification(version) {
            // Remove existing notification if any
            const existing = document.getElementById('updateNotification');
            if (existing) existing.remove();
            
            const notification = document.createElement('div');
            notification.id = 'updateNotification';
            notification.innerHTML = `
                <div class="update-popup">
                    <div class="update-icon"><i class="fas fa-rocket"></i></div>
                    <div class="update-content">
                        <h3>New Update Available!</h3>
                        <p>Version ${version} with new features & improvements</p>
                        <p class="update-note">Premium UI + Tree Information for Agriculture Students</p>
                    </div>
                    <div class="update-buttons">
                        <button onclick="location.reload()" class="update-btn-primary">
                            <i class="fas fa-download"></i> Update Now
                        </button>
                    </div>
                </div>
            `;
            document.body.appendChild(notification);
        }
        
        // Auto check for updates every time page loads
        window.addEventListener('load', () => {
            const lastVersion = localStorage.getItem('ecotree_version');
            const currentVersion = '3.3.0';
            
            if (lastVersion !== currentVersion) {
                // Show update popup for new users or when version changes
                setTimeout(() => {
                    showUpdateNotification(currentVersion);
                    localStorage.setItem('ecotree_version', currentVersion);
                }, 1500);
            }
        });
    </script>
    <style>
        /* Update Popup */
        .update-popup {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(17, 29, 51, 0.98);
            border: 1px solid rgba(255,255,255,0.1);
            color: white;
            padding: 40px;
            border-radius: 24px;
            box-shadow: 0 25px 80px rgba(0,0,0,0.5);
            z-index: 10001;
            text-align: center;
            min-width: 320px;
            max-width: 90%;
            animation: popIn 0.4s ease-out;
            backdrop-filter: blur(16px);
        }
        
        @keyframes popIn {
            from { transform: translate(-50%, -50%) scale(0.9); opacity: 0; }
            to { transform: translate(-50%, -50%) scale(1); opacity: 1; }
        }
        
        .update-icon {
            font-size: 48px;
            margin-bottom: 16px;
        }
        
        .update-content h3 {
            font-size: 1.4rem;
            margin-bottom: 8px;
            font-weight: 800;
            color: rgba(255,255,255,.95);
        }
        
        .update-content p {
            font-size: 0.88rem;
            color: rgba(255,255,255,.5);
            margin-bottom: 4px;
        }
        
        .update-note {
            background: rgba(16,185,129,0.1);
            border: 1px solid rgba(16,185,129,0.15);
            padding: 10px 15px;
            border-radius: 10px;
            margin-top: 12px !important;
            font-size: 0.82rem !important;
            color: #34d399 !important;
        }
        
        .update-buttons {
            margin-top: 20px;
        }
        
        .update-btn-primary {
            background: linear-gradient(135deg, #10b981, #059669);
            color: white;
            border: none;
            padding: 14px 36px;
            border-radius: 14px;
            font-size: 1rem;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            font-family: inherit;
        }
        
        .update-btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 30px rgba(16,185,129,0.3);
        }
        
        #updateNotification::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.6);
            backdrop-filter: blur(5px);
            z-index: 10000;
        }

        /* Header action buttons */
        .header-action-btn {
            padding: 8px 18px;
            font-size: 0.82rem;
            border-radius: 10px;
            border: 1px solid rgba(255,255,255,0.1);
            cursor: pointer;
            font-family: inherit;
            font-weight: 600;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 6px;
            color: rgba(255,255,255,0.7);
            background: rgba(255,255,255,0.06);
        }
        .header-action-btn:hover { background: rgba(255,255,255,0.1); color: #fff; }
        .logout-btn-header { background: rgba(239,68,68,0.1); color: #fca5a5; border-color: rgba(239,68,68,0.15); }
        .logout-btn-header:hover { background: rgba(239,68,68,0.2); }
        .install-btn-header { background: rgba(16,185,129,0.1); color: #34d399; border-color: rgba(16,185,129,0.15); }
        .install-btn-header:hover { background: rgba(16,185,129,0.2); }
    </style>

    <!-- ML Tree Measurement Script -->
    <script src="ml-tree-measurement.js"></script>
    <script src="advanced-ml-measurement.js"></script>
    <script src="camera-handler.js"></script>
</body>
</html>
