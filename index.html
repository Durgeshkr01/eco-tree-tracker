<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="theme-color" content="#27ae60">
    <meta name="description" content="Calculate tree's carbon absorption, oxygen production & environmental impact">
    <title>üå≥ EcoTree Tracker - Tree Carbon & Oxygen Calculator</title>
    <link rel="icon" type="image/svg+xml" href="favicon.svg">
    <link rel="manifest" href="manifest.json">
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="container">
            <div class="header-content">
                <img src="logo.svg" alt="EcoTree Tracker Logo" class="logo">
                <div class="header-text">
                    <h1>üå≥ EcoTree Tracker</h1>
                    <p>Calculate carbon absorption, oxygen production & environmental impact</p>
                </div>
                <button id="installBtn" class="install-btn" style="display: none;">
                    <i class="fas fa-download"></i> Install App
                </button>
            </div>
        </div>
    </header>

    <!-- Main Container -->
    <main class="container">
        <!-- Input Form Section -->
        <section class="card input-section">
            <h2><i class="fas fa-tree"></i> Tree Details</h2>
            <form id="treeForm">
                <!-- Tree Species -->
                <div class="form-group">
                    <label for="treeSpecies">
                        <i class="fas fa-leaf"></i> Tree Species
                    </label>
                    <select id="treeSpecies" required>
                        <option value="">Select Tree Species</option>
                    </select>
                </div>

                <!-- Height Input -->
                <div class="form-group">
                    <label for="height">
                        <i class="fas fa-ruler-vertical"></i> Tree Height
                    </label>
                    <div class="input-with-unit">
                        <input type="number" id="height" step="0.1" min="0.1" placeholder="Enter height" required>
                        <select id="heightUnit">
                            <option value="m">Meters (m)</option>
                            <option value="ft">Feet (ft)</option>
                            <option value="cm">Centimeters (cm)</option>
                        </select>
                    </div>
                </div>

                <!-- DBH Input -->
                <div class="form-group">
                    <label for="dbh">
                        <i class="fas fa-arrows-alt-h"></i> DBH (Diameter at Breast Height)
                    </label>
                    <div class="input-with-unit">
                        <input type="number" id="dbh" step="0.1" min="0.1" placeholder="Enter diameter" required>
                        <select id="dbhUnit">
                            <option value="cm">Centimeters (cm)</option>
                            <option value="in">Inches (in)</option>
                        </select>
                    </div>
                </div>

                <!-- Age (Optional) -->
                <div class="form-group">
                    <label for="age">
                        <i class="fas fa-calendar-alt"></i> Tree Age (Optional)
                    </label>
                    <input type="number" id="age" min="1" placeholder="Enter age in years">
                </div>

                <!-- Location (Optional) -->
                <div class="form-group">
                    <label for="location">
                        <i class="fas fa-map-marker-alt"></i> Location (Optional)
                    </label>
                    <input type="text" id="location" placeholder="e.g., Mumbai, Delhi">
                </div>

                <!-- Calculate Button -->
                <button type="submit" class="btn-primary">
                    <i class="fas fa-calculator"></i> Calculate
                </button>
            </form>
        </section>

        <!-- Results Section -->
        <section id="resultsSection" class="results-section" style="display: none;">
            <div class="results-header">
                <h2><i class="fas fa-chart-line"></i> Calculation Results</h2>
                <div class="action-buttons">
                    <button id="downloadPDF" class="btn-secondary">
                        <i class="fas fa-download"></i> Download PDF
                    </button>
                    <button id="shareBtn" class="btn-secondary">
                        <i class="fas fa-share-alt"></i> Share
                    </button>
                </div>
            </div>

            <!-- Tree Info Summary -->
            <div class="tree-summary card">
                <h3 id="treeName">Tree Information</h3>
                <div class="tree-details" id="treeDetails"></div>
            </div>

            <!-- Results Cards Grid -->
            <div class="results-grid">
                <!-- Biomass Card -->
                <div class="result-card card">
                    <div class="card-icon biomass-icon">
                        <i class="fas fa-weight"></i>
                    </div>
                    <h3>Total Biomass</h3>
                    <div class="result-value" id="biomassValue">0</div>
                    <div class="result-unit">kg</div>
                    <div class="result-breakdown">
                        <small>Above-ground: <span id="agbValue">0</span> kg</small>
                        <small>Below-ground: <span id="bgbValue">0</span> kg</small>
                    </div>
                </div>

                <!-- Carbon Stored Card -->
                <div class="result-card card">
                    <div class="card-icon carbon-icon">
                        <i class="fas fa-atom"></i>
                    </div>
                    <h3>Carbon Stored</h3>
                    <div class="result-value" id="carbonValue">0</div>
                    <div class="result-unit">kg C</div>
                    <div class="result-info">
                        <small>Locked in tree biomass</small>
                    </div>
                </div>

                <!-- CO2 Sequestration Card -->
                <div class="result-card card highlight">
                    <div class="card-icon co2-icon">
                        <i class="fas fa-cloud"></i>
                    </div>
                    <h3>CO‚ÇÇ Absorbed</h3>
                    <div class="result-value" id="co2Value">0</div>
                    <div class="result-unit">kg CO‚ÇÇ/year</div>
                    <div class="result-info">
                        <small>Annual carbon sequestration</small>
                    </div>
                </div>

                <!-- Oxygen Production Card -->
                <div class="result-card card highlight">
                    <div class="card-icon oxygen-icon">
                        <i class="fas fa-wind"></i>
                    </div>
                    <h3>Oxygen Produced</h3>
                    <div class="result-value" id="oxygenValue">0</div>
                    <div class="result-unit">kg O‚ÇÇ/year</div>
                    <div class="result-info">
                        <small>Fresh air generated</small>
                    </div>
                </div>

                <!-- Air Pollution Card -->
                <div class="result-card card">
                    <div class="card-icon pollution-icon">
                        <i class="fas fa-smog"></i>
                    </div>
                    <h3>Pollution Absorbed</h3>
                    <div class="result-value" id="pollutionValue">0</div>
                    <div class="result-unit">kg/year</div>
                    <div class="result-info">
                        <small>PM2.5, NO‚ÇÇ, SO‚ÇÇ removed</small>
                    </div>
                </div>

                <!-- Economic Value Card -->
                <div class="result-card card">
                    <div class="card-icon economic-icon">
                        <i class="fas fa-rupee-sign"></i>
                    </div>
                    <h3>Economic Value</h3>
                    <div class="result-value" id="economicValue">0</div>
                    <div class="result-unit">‚Çπ/year</div>
                    <div class="result-info">
                        <small>Carbon credit value</small>
                    </div>
                </div>
            </div>

            <!-- Environmental Impact Summary -->
            <div class="card impact-summary">
                <h3><i class="fas fa-globe-americas"></i> Environmental Impact</h3>
                <div class="impact-grid">
                    <div class="impact-item">
                        <i class="fas fa-users"></i>
                        <div>
                            <strong id="peopleEquivalent">0</strong>
                            <small>People's oxygen supply (annual)</small>
                        </div>
                    </div>
                    <div class="impact-item">
                        <i class="fas fa-car"></i>
                        <div>
                            <strong id="carEquivalent">0</strong>
                            <small>km of car emissions offset</small>
                        </div>
                    </div>
                    <div class="impact-item">
                        <i class="fas fa-home"></i>
                        <div>
                            <strong id="homeEquivalent">0</strong>
                            <small>Days of home energy offset</small>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- History Section -->
        <section class="card history-section">
            <div class="history-header">
                <h2><i class="fas fa-history"></i> Calculation History</h2>
                <button id="clearHistory" class="btn-clear">
                    <i class="fas fa-trash"></i> Clear All
                </button>
            </div>
            <div id="historyList" class="history-list">
                <p class="no-history">No calculations yet. Start by calculating a tree's impact!</p>
            </div>
        </section>
    </main>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <p>üåç Based on research: AGB = 34.4703 - 8.0671√óD + 0.6589√óD¬≤</p>
            <p>Made with üíö for a greener planet | <strong>EcoTree Tracker</strong></p>
        </div>
    </footer>

    <!-- Scripts -->
    <script type="module" src="firebase-config.js"></script>
    <script src="tree-data.js"></script>
    <script src="calculator.js"></script>
    <script src="app.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    
    <!-- PWA Service Worker Registration -->
    <script>
        // Register Service Worker
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('/service-worker.js')
                    .then(reg => console.log('‚úÖ Service Worker registered!'))
                    .catch(err => console.log('‚ùå Service Worker registration failed:', err));
            });
        }

        // PWA Install Button Logic
        let deferredPrompt;
        const installBtn = document.getElementById('installBtn');

        window.addEventListener('beforeinstallprompt', (e) => {
            e.preventDefault();
            deferredPrompt = e;
            installBtn.style.display = 'flex';
        });

        installBtn.addEventListener('click', async () => {
            if (!deferredPrompt) return;
            
            deferredPrompt.prompt();
            const { outcome } = await deferredPrompt.choiceResult;
            
            if (outcome === 'accepted') {
                console.log('üéâ App installed!');
            }
            
            deferredPrompt = null;
            installBtn.style.display = 'none';
        });

        window.addEventListener('appinstalled', () => {
            console.log('‚úÖ EcoTree Tracker installed successfully!');
            installBtn.style.display = 'none';
        });
    </script>
</body>
</html>
