<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CO2 Heat Map - EcoTree Tracker</title>
    <link rel="icon" type="image/svg+xml" href="favicon.svg">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster@1.5.3/dist/MarkerCluster.css" />
    <link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster@1.5.3/dist/MarkerCluster.Default.css" />
    <style>
        *{margin:0;padding:0;box-sizing:border-box}
        body{font-family:'Inter','Segoe UI',sans-serif;background:#0a1628;overflow:hidden;color:#fff}

        /* Top Bar */
        .top-bar{height:56px;padding:0 20px;display:flex;justify-content:space-between;align-items:center;background:rgba(10,22,40,.9);backdrop-filter:blur(16px);-webkit-backdrop-filter:blur(16px);border-bottom:1px solid rgba(255,255,255,.06);z-index:1000;position:relative}
        .top-bar h1{font-size:1.05rem;font-weight:700;display:flex;align-items:center;gap:10px;color:rgba(255,255,255,.9)}
        .top-bar h1 i{color:#10b981;font-size:18px}
        .top-actions{display:flex;gap:8px}
        .top-actions a,.top-actions button{color:rgba(255,255,255,.7);text-decoration:none;padding:8px 16px;border-radius:10px;background:rgba(255,255,255,.06);border:1px solid rgba(255,255,255,.08);font-family:inherit;font-size:.8rem;font-weight:600;cursor:pointer;transition:all .3s;display:flex;align-items:center;gap:6px}
        .top-actions a:hover,.top-actions button:hover{background:rgba(255,255,255,.1);color:#fff}
        .top-actions .btn-danger{background:rgba(239,68,68,.1);color:#fca5a5;border-color:rgba(239,68,68,.15)}
        .top-actions .btn-danger:hover{background:rgba(239,68,68,.2)}

        /* Layout */
        .map-container{display:flex;height:calc(100vh - 56px)}

        /* Sidebar */
        .sidebar{width:300px;background:rgba(10,22,40,.95);overflow-y:auto;border-right:1px solid rgba(255,255,255,.06);z-index:999;display:flex;flex-direction:column}
        .sidebar-section{padding:20px;border-bottom:1px solid rgba(255,255,255,.06)}
        .sidebar-section h2{font-size:.8rem;font-weight:700;color:rgba(255,255,255,.4);text-transform:uppercase;letter-spacing:.5px;margin-bottom:14px;display:flex;align-items:center;gap:8px}
        .sidebar-section h2 i{color:#10b981;font-size:14px}

        .s-stat{background:rgba(255,255,255,.04);border:1px solid rgba(255,255,255,.06);border-radius:12px;padding:14px 16px;margin-bottom:10px}
        .s-stat .label{color:rgba(255,255,255,.4);font-size:.75rem;font-weight:500;margin-bottom:4px}
        .s-stat .value{font-size:1.4rem;font-weight:800;color:rgba(255,255,255,.95)}
        .s-stat .unit{color:#10b981;font-size:.75rem;font-weight:600}

        .ctrl-btn{width:100%;padding:12px;border:none;border-radius:10px;font-family:inherit;font-size:.82rem;font-weight:600;cursor:pointer;transition:all .3s;display:flex;align-items:center;justify-content:center;gap:8px;margin-bottom:8px}
        .ctrl-btn.primary{background:rgba(16,185,129,.12);color:#34d399;border:1px solid rgba(16,185,129,.2)}
        .ctrl-btn.primary.active{background:rgba(16,185,129,.2);color:#6ee7b7}
        .ctrl-btn.primary:hover{background:rgba(16,185,129,.2)}
        .ctrl-btn.refresh{background:rgba(59,130,246,.1);color:#60a5fa;border:1px solid rgba(59,130,246,.15)}
        .ctrl-btn.refresh:hover{background:rgba(59,130,246,.18)}
        .ctrl-btn.danger{background:rgba(239,68,68,.08);color:#fca5a5;border:1px solid rgba(239,68,68,.12)}
        .ctrl-btn.danger:hover{background:rgba(239,68,68,.15)}

        /* Map */
        .map-wrap{position:relative;flex:1;background:#0d1b2a}
        #map{width:100%;height:100%}

        /* Legend */
        .legend{position:absolute;bottom:20px;right:20px;background:rgba(10,22,40,.9);backdrop-filter:blur(12px);-webkit-backdrop-filter:blur(12px);padding:14px 18px;border-radius:12px;border:1px solid rgba(255,255,255,.08);z-index:999;font-size:.78rem}
        .legend h4{color:rgba(255,255,255,.6);margin-bottom:10px;font-size:.72rem;text-transform:uppercase;letter-spacing:.5px}
        .legend-item{display:flex;align-items:center;gap:8px;margin-bottom:6px;color:rgba(255,255,255,.55)}
        .legend-color{width:24px;height:12px;border-radius:3px}

        /* No Data */
        .no-data{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);text-align:center;background:rgba(17,29,51,.95);backdrop-filter:blur(16px);-webkit-backdrop-filter:blur(16px);border:1px solid rgba(255,255,255,.08);padding:40px;border-radius:20px;z-index:1000}
        .no-data i{font-size:3rem;color:rgba(16,185,129,.4);margin-bottom:16px;display:block}
        .no-data h3{color:rgba(255,255,255,.8);margin-bottom:8px;font-size:1.1rem}
        .no-data p{color:rgba(255,255,255,.4);font-size:.85rem;margin-bottom:16px}
        .no-data a{display:inline-flex;align-items:center;gap:6px;padding:10px 20px;background:rgba(16,185,129,.12);color:#34d399;border:1px solid rgba(16,185,129,.2);border-radius:10px;text-decoration:none;font-weight:600;font-size:.82rem;transition:all .3s}
        .no-data a:hover{background:rgba(16,185,129,.2)}

        /* Dark Leaflet tiles */
        .leaflet-container{background:#0d1b2a}

        @media(max-width:768px){
            .map-container{flex-direction:column}
            .sidebar{width:100%;height:auto;max-height:40vh;order:2;border-right:none;border-top:1px solid rgba(255,255,255,.06)}
            .map-wrap{height:60vh;order:1}
            #map{height:100%}
            .legend{bottom:8px;right:8px;padding:10px 14px}
            .top-actions span{display:none}
        }
    </style>
</head>
<body>
    <div class="top-bar">
        <h1><i class="fas fa-map-marked-alt"></i> CO2 Heat Map</h1>
        <div class="top-actions">
            <a href="index.html"><i class="fas fa-calculator"></i> <span>Calculator</span></a>
            <button onclick="logout()" class="btn-danger"><i class="fas fa-sign-out-alt"></i> <span>Logout</span></button>
        </div>
    </div>

    <div class="map-container">
        <div class="sidebar">
            <div class="sidebar-section">
                <h2><i class="fas fa-chart-bar"></i> Statistics</h2>
                <div class="s-stat">
                    <div class="label">Total Trees</div>
                    <div class="value" id="totalTrees">0</div>
                </div>
                <div class="s-stat">
                    <div class="label">Total CO2 Absorbed</div>
                    <div class="value" id="totalCO2">0 <span class="unit">kg</span></div>
                </div>
                <div class="s-stat">
                    <div class="label">Avg per Tree</div>
                    <div class="value" id="avgCO2">0 <span class="unit">kg</span></div>
                </div>
                <div class="s-stat">
                    <div class="label">Top Species</div>
                    <div class="value" id="topSpecies" style="font-size:1rem">-</div>
                </div>
            </div>
            <div class="sidebar-section">
                <h2><i class="fas fa-sliders-h"></i> Controls</h2>
                <button class="ctrl-btn primary active" id="viewToggle">
                    <i class="fas fa-fire"></i> <span id="viewMode">Heat Map View</span>
                </button>
                <button class="ctrl-btn refresh" id="refreshBtn">
                    <i class="fas fa-sync-alt"></i> Refresh Data
                </button>
                <button class="ctrl-btn danger" id="clearDataBtn">
                    <i class="fas fa-trash-alt"></i> Clear All Data
                </button>
            </div>
        </div>

        <div class="map-wrap">
            <div id="map"></div>
            <div class="legend">
                <h4>CO2 Absorption</h4>
                <div class="legend-item"><div class="legend-color" style="background:#00ff00"></div>High (&gt;100 kg)</div>
                <div class="legend-item"><div class="legend-color" style="background:#ffaa00"></div>Medium (50-100 kg)</div>
                <div class="legend-item"><div class="legend-color" style="background:#ff0000"></div>Low (&lt;50 kg)</div>
            </div>
            <div class="no-data" id="noDataMsg" style="display:none">
                <i class="fas fa-map-marker-alt"></i>
                <h3>No Data Yet</h3>
                <p>Start recording trees to see them on the map</p>
                <a href="index.html"><i class="fas fa-calculator"></i> Go to Calculator</a>
            </div>
        </div>
    </div>

    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script src="https://unpkg.com/leaflet.heat@0.2.0/dist/leaflet-heat.js"></script>
    <script src="https://unpkg.com/leaflet.markercluster@1.5.3/dist/leaflet.markercluster.js"></script>
    <script src="map.js"></script>
</body>
</html>
